{% extends 'base.html' %}
{% load static %}
{% block title %} | Demande de Cours{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row g-0">
        <!-- Sidebar Column -->
        <div class="col-lg-2 d-none d-lg-block">
            {% include 'partials/_sidebar_eleve.html' %}
        </div>

        <!-- Main Content Column -->
        <div class="col-lg-10 col-md-12">
            <div class="container-fluid py-4 px-4">
                <!-- Header Section -->
                <!-- <div class="text-center mb-5">
                    <h3 class="section-title text-primary">
                        <i class="fas fa-paper-plane me-2"></i>Envoyer une demande de cours
                    </h3>
                    <hr class="w-25 mx-auto bg-primary opacity-75" style="height: 2px;">
                </div> -->
                <div class="text-center wow fadeInUp" data-wow-delay="0.1s"
                    style="visibility: visible; animation-delay: 0.1s; animation-name: fadeInUp;">
                    <h3 class="section-title bg-white text-center text-primary px-3"><i class="fas fa-paper-plane me-2"></i>Envoyer l'email</h3>
                </div>

                <!-- Alerts Section -->
                <div class="row mb-4">
                    <div class="col-12">
                        {% include 'partials/_alerts.html' %}
                    </div>
                </div>

                <!-- Email Form -->
                <form method="POST" enctype="multipart/form-data" autocomplete="off" action="{% url 'reponse_email_eleve' %}">
                    {% csrf_token %}
                    
                    <!-- Email Content Card -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <div class="row g-4">
                                <!-- Email Address -->
                                <div class="col-md-6">
                                    <label for="email_adresse_id" class="form-label fw-bold">
                                        <i class="fas fa-envelope me-2 text-primary"></i>Votre adresse email
                                    </label>
                                    <input type="email" class="form-control" id="email_adresse_id" 
                                           name="email_adresse" value="{{email_eleve}}" required>
                                </div>
                                
                                <!-- Subject -->
                                <div class="col-md-6">
                                    <label for="sujet_id" class="form-label fw-bold">
                                        <i class="fas fa-tag me-2 text-primary"></i>Sujet de l'email
                                    </label>
                                    <input type="text" class="form-control" id="sujet_id" 
                                           name="sujet" value="{{sujet}}" required>
                                </div>
                                
                                <!-- Message Content -->
                                <div class="col-12 mt-3">
                                    <label for="text_email_id" class="form-label fw-bold">
                                        <i class="fas fa-comment-alt me-2 text-primary"></i>Contenu de votre message
                                    </label>
                                    <textarea class="form-control auto-resize" id="text_email_id" rows="8" 
                                              name="text_email" required>{{text_email}}
---------------------------
En réponse à votre email, je vous adresse ce qui suit.</textarea>
                                    <div class="form-text mt-2">
                                        Soyez aussi précis que possible dans votre demande pour une réponse optimale.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="card shadow-sm">
                        <div class="card-body text-center">
                            <button type="submit" class="btn btn-primary btn-lg px-5" name="btn_enr">
                                <i class="fas fa-paper-plane me-2"></i>Envoyer l'email
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Back to Top Button -->
<a href="#" class="btn btn-primary btn-lg-square back-to-top position-fixed">
    <i class="fas fa-arrow-up"></i>
</a>

<style>
    .back-to-top {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 99;
        opacity: 0.7;
        transition: all 0.3s;
    }
    
    .back-to-top:hover {
        opacity: 1;
        transform: translateY(-3px);
    }
    
    .card {
        border: none;
        border-radius: 10px;
    }
    
    
    
    .auto-resize {
        min-height: 200px;
        resize: none;
        overflow-y: hidden;
        line-height: 1.6;
    }
    
    .form-control {
        padding: 12px;
        border-radius: 8px;
    }
    
    textarea.form-control {
        background-color: #f8f9fa;
    }
</style>
{% endblock %}

{% block javascript %}
<script>
    // Auto-resize textareas
    document.addEventListener('DOMContentLoaded', function() {
        const textareas = document.querySelectorAll('.auto-resize');
        
        textareas.forEach(textarea => {
            // Initial adjustment
            textarea.style.height = 'auto';
            textarea.style.height = (textarea.scrollHeight) + 'px';
            
            // Adjust on input
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });
        });

        // Add basic form validation
        const form = document.querySelector('form');
        form.addEventListener('submit', function(e) {
            const requiredFields = form.querySelectorAll('[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.classList.add('is-invalid');
                    isValid = false;
                } else {
                    field.classList.remove('is-invalid');
                }
            });
            
            if (!isValid) {
                e.preventDefault();
                alert('Veuillez remplir tous les champs obligatoires.');
            }
        });
    });
</script>
{% endblock %}